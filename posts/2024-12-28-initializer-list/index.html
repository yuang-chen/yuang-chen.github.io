<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Initializer List | Yac's Log</title><meta name=keywords content="C++"><meta name=description content="In a prior post, I talked about list initialization, which is differs from initializer_list discussed here. Though personally, I don&rsquo;t find initializer_list really useful as I never used it in my projects.
list initialization is a general syntax using {} for initializing a variety of variables and objects. initializer_list is a template class representing a lightweight, read-only array of elements, typically used in constructors or functions. initializer_list promotes safety, flexibility and modern tone compared to the raw array."><meta name=author content="Me"><link rel=canonical href=https://yuang-chen.github.io/posts/2024-12-28-initializer-list/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://yuang-chen.github.io/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://yuang-chen.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://yuang-chen.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://yuang-chen.github.io/favicon/apple-touch-icon.ico><link rel=mask-icon href=https://yuang-chen.github.io/favicon/favicon-32x32.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css integrity=sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.js integrity=sha384-Qsn9KnoKISj6dI8g7p1HBlNpVx0I8p1SvlwOldgi3IorMle61nQy4zEahWYtljaz crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Initializer List"><meta property="og:description" content="In a prior post, I talked about list initialization, which is differs from initializer_list discussed here. Though personally, I don&rsquo;t find initializer_list really useful as I never used it in my projects.
list initialization is a general syntax using {} for initializing a variety of variables and objects. initializer_list is a template class representing a lightweight, read-only array of elements, typically used in constructors or functions. initializer_list promotes safety, flexibility and modern tone compared to the raw array."><meta property="og:type" content="article"><meta property="og:url" content="https://yuang-chen.github.io/posts/2024-12-28-initializer-list/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-28T23:03:50+08:00"><meta property="article:modified_time" content="2024-12-28T23:03:50+08:00"><meta property="og:site_name" content="Yac's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Initializer List"><meta name=twitter:description content="In a prior post, I talked about list initialization, which is differs from initializer_list discussed here. Though personally, I don&rsquo;t find initializer_list really useful as I never used it in my projects.
list initialization is a general syntax using {} for initializing a variety of variables and objects. initializer_list is a template class representing a lightweight, read-only array of elements, typically used in constructors or functions. initializer_list promotes safety, flexibility and modern tone compared to the raw array."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yuang-chen.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Initializer List","item":"https://yuang-chen.github.io/posts/2024-12-28-initializer-list/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Initializer List","name":"Initializer List","description":"In a prior post, I talked about list initialization, which is differs from initializer_list discussed here. Though personally, I don\u0026rsquo;t find initializer_list really useful as I never used it in my projects.\nlist initialization is a general syntax using {} for initializing a variety of variables and objects. initializer_list is a template class representing a lightweight, read-only array of elements, typically used in constructors or functions. initializer_list promotes safety, flexibility and modern tone compared to the raw array.","keywords":["C++"],"articleBody":"In a prior post, I talked about list initialization, which is differs from initializer_list discussed here. Though personally, I don’t find initializer_list really useful as I never used it in my projects.\nlist initialization is a general syntax using {} for initializing a variety of variables and objects. initializer_list is a template class representing a lightweight, read-only array of elements, typically used in constructors or functions. initializer_list promotes safety, flexibility and modern tone compared to the raw array. The example below shows the usage of initializer_list.\nCode #include void Receiver(std::initializer_list\u003cint\u003e list); //the code cannot be correctly executed due to the missing definition void Fun() { std::initializer_list\u003cint\u003e list{3, 4, 5, 6}; Receiver(list); // Pass the initializer list } int main () { Fun(); return 0; } With C++ Insights, we can see the compiler generates the code below. The initializer_list turns out to be a view-like wrapper around a pointer to a backing array and the size of the array.\n#include void Receiver(std::initializer_list\u003cint\u003e list); void Fun() { const int __list8_36[4] = {3, 4, 5, 6}; // create an array std::initializer_list\u003cint\u003e list = std::initializer_list\u003cint\u003e{__list8_36, 4}; // a pointer to the array and the size Receiver(std::initializer_list\u003cint\u003e(list)); } int main() { Fun(); return 0; } We further investigate the code with the generated assembly code. With g++13, the compiler generates the code below:\nFun(): sub rsp, 24 // Stack Allocation movdqa xmm0, XMMWORD PTR .LC0[rip] // Load the constant pool into xmm0 mov esi, 4 mov rdi, rsp movaps XMMWORD PTR [rsp], xmm0 // Copy the data from xmm0 to the stack call Receiver(std::initializer_list\u003cint\u003e) add rsp, 24 ret main: sub rsp, 24 movdqa xmm0, XMMWORD PTR .LC0[rip] mov esi, 4 // set as the array size 4 mov rdi, rsp // rdi is set to the stack pointer (address of the copied array) movaps XMMWORD PTR [rsp], xmm0 call Receiver(std::initializer_list\u003cint\u003e) xor eax, eax add rsp, 24 ret .LC0: //Constant Pool .long 3 .long 4 .long 5 .long 6 g++14 compiler optimizes the initializer_list by generating a static backing array:\nFun(): mov edi, OFFSET FLAT:C.0.0 // edi is loaded with the address of the static array mov esi, 4 // set as the array size 4 jmp Receiver(std::initializer_list\u003cint\u003e) main: sub rsp, 8 mov edi, OFFSET FLAT:C.0.0 mov esi, 4 call Receiver(std::initializer_list\u003cint\u003e) xor eax, eax add rsp, 8 ret C.0.0: // Static Data Section .long 3 .long 4 .long 5 .long 6 Aspect ASM with g++14 ASM with g++13 Memory Allocation Backing array stored in the static data section (C.0.0) Backing array copied onto the stack during function execution Lifetime Persistent for the lifetime of the program Temporary: exists only during the function’s execution Performance More efficient: no copying required Less efficient: incurs copying overhead to stack memory Stack Usage No stack memory used for the array Consumes stack space (24 bytes in this case) Instruction Set Simple memory reference and register loads Involves SIMD instructions (e.g., movdqa) and stack operations Reusability Data can be reused without reallocation Backing array is unique to each function call The optimization of g++14 on the initializer_list is actually introduced by C++26, and backported to lower standard version (e.g., C++17, C++20) with compatible compiler. Though this optimization is a bit trivial, learning the benefit of static is still useful.\n","wordCount":"541","inLanguage":"en","datePublished":"2024-12-28T23:03:50+08:00","dateModified":"2024-12-28T23:03:50+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yuang-chen.github.io/posts/2024-12-28-initializer-list/"},"publisher":{"@type":"Organization","name":"Yac's Log","logo":{"@type":"ImageObject","url":"https://yuang-chen.github.io/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yuang-chen.github.io/ accesskey=h title="Yac's Log (Alt + H)"><img src=https://yuang-chen.github.io/facebook alt aria-label=logo height=35>Yac's Log</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yuang-chen.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://yuang-chen.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://yuang-chen.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://yuang-chen.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://yuang-chen.github.io/about/aboutme title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Initializer List</h1><div class=post-meta><span title='2024-12-28 23:03:50 +0800 CST'>December 28, 2024</span>&nbsp;·&nbsp;541 words&nbsp;·&nbsp;Me</div></header><div class=post-content><p>In a prior <a href=https://yuang-chen.github.io/posts/2023-10-29-initialization-with-brackets/>post</a>, I talked about <code>list initialization</code>, which is differs from <code>initializer_list</code> discussed here. Though personally, I don&rsquo;t find <code>initializer_list</code> really useful as I never used it in my projects.</p><ul><li><code>list initialization </code>is a general syntax using {} for initializing a variety of variables and objects.</li><li><code>initializer_list</code> is a template class representing a lightweight, read-only array of elements, typically used in constructors or functions.</li></ul><p><code>initializer_list</code> promotes safety, flexibility and modern tone compared to the raw array. The example below shows the usage of <code>initializer_list</code>.</p><h3 id=code>Code<a hidden class=anchor aria-hidden=true href=#code>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;initializer_list&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Receiver</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>list</span><span class=p>);</span> <span class=c1>//the code cannot be correctly executed due to the missing definition
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Fun</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>list</span><span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>Receiver</span><span class=p>(</span><span class=n>list</span><span class=p>);</span> <span class=c1>// Pass the initializer list
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Fun</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>With C++ Insights, we can see the compiler generates the code below. The <code>initializer_list</code> turns out to be a view-like wrapper around a <code>pointer</code> to a backing <code>array</code> and the <code>size</code> of the array.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;initializer_list&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Receiver</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>list</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Fun</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>const</span> <span class=kt>int</span> <span class=n>__list8_36</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>};</span> <span class=c1>// create an array
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>std</span><span class=o>::</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>{</span><span class=n>__list8_36</span><span class=p>,</span> <span class=mi>4</span><span class=p>};</span> <span class=c1>// a pointer to the array and the size
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>Receiver</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>list</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Fun</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We further investigate the code with the generated assembly code. With <code>g++13</code>, the compiler generates the code below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=nf>Fun</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nf>sub</span>     <span class=no>rsp</span><span class=p>,</span> <span class=mi>24</span> <span class=c1>// Stack Allocation
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>movdqa</span>  <span class=no>xmm0</span><span class=p>,</span> <span class=no>XMMWORD</span> <span class=no>PTR</span> <span class=no>.LC0</span><span class=p>[</span><span class=no>rip</span><span class=p>]</span> <span class=c1>// Load the constant pool into xmm0
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>mov</span>     <span class=no>esi</span><span class=p>,</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=nf>mov</span>     <span class=no>rdi</span><span class=p>,</span> <span class=no>rsp</span>
</span></span><span class=line><span class=cl>        <span class=nf>movaps</span>  <span class=no>XMMWORD</span> <span class=no>PTR</span> <span class=p>[</span><span class=no>rsp</span><span class=p>],</span> <span class=no>xmm0</span> <span class=c1>// Copy the data from xmm0 to the stack
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>call</span>    <span class=no>Receiver</span><span class=p>(</span><span class=no>std</span><span class=p>::</span><span class=no>initializer_list</span><span class=err>&lt;</span><span class=no>int</span><span class=err>&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nf>add</span>     <span class=no>rsp</span><span class=p>,</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl>        <span class=nf>ret</span>
</span></span><span class=line><span class=cl><span class=nl>main:</span>
</span></span><span class=line><span class=cl>        <span class=nf>sub</span>     <span class=no>rsp</span><span class=p>,</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl>        <span class=nf>movdqa</span>  <span class=no>xmm0</span><span class=p>,</span> <span class=no>XMMWORD</span> <span class=no>PTR</span> <span class=no>.LC0</span><span class=p>[</span><span class=no>rip</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nf>mov</span>     <span class=no>esi</span><span class=p>,</span> <span class=mi>4</span>   <span class=c1>// set as the array size 4
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>mov</span>     <span class=no>rdi</span><span class=p>,</span> <span class=no>rsp</span>  <span class=c1>// rdi is set to the stack pointer (address of the copied array)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>movaps</span>  <span class=no>XMMWORD</span> <span class=no>PTR</span> <span class=p>[</span><span class=no>rsp</span><span class=p>],</span> <span class=no>xmm0</span>
</span></span><span class=line><span class=cl>        <span class=nf>call</span>    <span class=no>Receiver</span><span class=p>(</span><span class=no>std</span><span class=p>::</span><span class=no>initializer_list</span><span class=err>&lt;</span><span class=no>int</span><span class=err>&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nf>xor</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>eax</span>
</span></span><span class=line><span class=cl>        <span class=nf>add</span>     <span class=no>rsp</span><span class=p>,</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl>        <span class=nf>ret</span>
</span></span><span class=line><span class=cl><span class=nl>.LC0:</span>   <span class=c1>//Constant Pool 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=na>.long</span>   <span class=mi>3</span>
</span></span><span class=line><span class=cl>        <span class=na>.long</span>   <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=na>.long</span>   <span class=mi>5</span>
</span></span><span class=line><span class=cl>        <span class=na>.long</span>   <span class=mi>6</span>
</span></span></code></pre></div><p><code>g++14</code> compiler optimizes the <code>initializer_list</code> by generating a <code>static</code> backing array:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=nf>Fun</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nf>mov</span>     <span class=no>edi</span><span class=p>,</span> <span class=no>OFFSET</span> <span class=no>FLAT</span><span class=p>:</span><span class=no>C.0.0</span>  <span class=c1>// edi is loaded with the address of the static array
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>mov</span>     <span class=no>esi</span><span class=p>,</span> <span class=mi>4</span>  <span class=c1>// set as the array size 4
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>jmp</span>     <span class=no>Receiver</span><span class=p>(</span><span class=no>std</span><span class=p>::</span><span class=no>initializer_list</span><span class=err>&lt;</span><span class=no>int</span><span class=err>&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nl>main:</span>
</span></span><span class=line><span class=cl>        <span class=nf>sub</span>     <span class=no>rsp</span><span class=p>,</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>        <span class=nf>mov</span>     <span class=no>edi</span><span class=p>,</span> <span class=no>OFFSET</span> <span class=no>FLAT</span><span class=p>:</span><span class=no>C.0.0</span>
</span></span><span class=line><span class=cl>        <span class=nf>mov</span>     <span class=no>esi</span><span class=p>,</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=nf>call</span>    <span class=no>Receiver</span><span class=p>(</span><span class=no>std</span><span class=p>::</span><span class=no>initializer_list</span><span class=err>&lt;</span><span class=no>int</span><span class=err>&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nf>xor</span>     <span class=no>eax</span><span class=p>,</span> <span class=no>eax</span>
</span></span><span class=line><span class=cl>        <span class=nf>add</span>     <span class=no>rsp</span><span class=p>,</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>        <span class=nf>ret</span>
</span></span><span class=line><span class=cl><span class=nl>C.0.0:</span>  <span class=c1>// Static Data Section
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=na>.long</span>   <span class=mi>3</span>
</span></span><span class=line><span class=cl>        <span class=na>.long</span>   <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=na>.long</span>   <span class=mi>5</span>
</span></span><span class=line><span class=cl>        <span class=na>.long</span>   <span class=mi>6</span>
</span></span></code></pre></div><table><thead><tr><th>Aspect</th><th>ASM with g++14</th><th>ASM with g++13</th></tr></thead><tbody><tr><td>Memory Allocation</td><td>Backing array stored in the <strong>static</strong> data section (C.0.0)</td><td>Backing array copied onto the <em>stack</em> during function execution</td></tr><tr><td>Lifetime</td><td>Persistent for the lifetime of the program</td><td>Temporary: exists only during the function&rsquo;s execution</td></tr><tr><td>Performance</td><td>More efficient: no copying required</td><td>Less efficient: incurs copying overhead to stack memory</td></tr><tr><td>Stack Usage</td><td>No stack memory used for the array</td><td>Consumes stack space (24 bytes in this case)</td></tr><tr><td>Instruction Set</td><td>Simple memory reference and register loads</td><td>Involves SIMD instructions (e.g., movdqa) and stack operations</td></tr><tr><td>Reusability</td><td>Data can be reused without reallocation</td><td>Backing array is unique to each function call</td></tr></tbody></table><p>The optimization of <code>g++14</code> on the <code>initializer_list</code> is actually introduced by C++26, and backported to lower standard version (e.g., C++17, C++20) with compatible compiler. Though this optimization is a bit trivial, learning the benefit of <code>static</code> is still useful.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://yuang-chen.github.io/tags/c++/>C++</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://yuang-chen.github.io/>Yac's Log</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>